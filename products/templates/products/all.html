{% extends 'base.html' %}
{% load static %}
{% load cart_tools %}
{% block extra_meta %}
<meta name="description" content="DESCRIPTION">
<!-- Each page should have a unique description. Page, not site. -->
<!-- Length can be up to 160 characters on desktop, 130 characters on mobile -->
<!-- You can have up to 158 description tags (although generally you won't need more than one per page) -->
<!-- Add a clear call to action, don't duplicate descriptions, include keywords, discounts, or offers if you're selling something -->

<meta name="keywords" content="KEYWORDS">
<!-- These are the keywords that your site can be searched with on Google -->
<!-- Make these single words, relevant to your site, often searched -->

<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- This sets the site up to be responsive, known as a responsive design meta tag. Don't use it if your site isn't responsive! -->
<!-- width makes the page match the screen's width, and initial scale sets the CSS pixels and the device pixels to a 1:1 ratio -->

<link rel="canonical" href="#">
<!-- This tells search engines to use this URL as the main page, and that it shouldn't index other pages -->
<!-- So if you have a site with multiple URLs, they're treated as seperate sites. This messes with the SEO, so putting this in
    with the correct link gives you better results, and more accuracy with data tracking -->

<meta name="robots" content="index, follow">
<!-- This tells search engines to index and follow this webpage. This is good for site crawlers like Google and Bing -->
<!-- noindex, nofollow is the opposite -->
<!-- Set it to noindex, nofollow for 'thin' pages (pages that don't have much information), where you don't want Google or
    Bing to judge your site based on that content -->

<title>SITE TITLE</title>
<!-- This is what will display in the tab at the top of a user's browser window -->
<!-- Title should be less than 60 characters -->
<!-- Unique title on every page, don't repeat yourself -->
<!-- Use words to indicate site function, use keywords with 4+ words, this should be your main keyword -->
<!-- Title can be changed to get the user's attention! 'Please come back, we miss you!', 'You have a new notification!' -->

<!-- Social media integration, for when people share your content -->
<!-- Facebook, LinkedIn, Google -->
<meta property="og:type" content="article" />
<meta property="og:title" content="TITLE OF YOUR POST OR PAGE" /> <!-- Same as what's inside <title> tag -->
<!-- The title you want displayed when your page is linked to -->
<meta property="og:description" content="DESCRIPTION OF PAGE CONTENT" />
<!-- Same as what's inside description meta tag -->
<!-- The description you want displayed when your page is linked to (maximum 300 characters) -->
<meta name="image" property="og:image" content="URL TO IMAGE" />
<!-- URL of image to be displayed when your site is linked to -->
<!-- Be careful when building non-static sites like your MS3 and MS4, this can be a little tricky -->
<meta property="og:image:alt" content="ALT TEXT FOR IMAGE" />
<!-- Alt text for above image - an accessibility win -->
<meta property="og:url" content="#" /> <!-- Your page's URL -->
<meta property="og:site_name" content="SITE NAME" /> <!-- Same as what's inside <title> tag -->
<meta name="author" content="AUTHOR NAME HERE"> <!-- Your name -->

<!-- Twitter -->
<meta name="twitter:card" content="summary"> <!-- Tells Twitter to expect information for a card -->
<meta name="twitter:title" content="TITLE OF POST OR PAGE"> <!-- Same as what's inside <title> tag -->
<!-- The title you want displayed when your page is linked to -->
<meta name="twitter:description" content="DESCRIPTION OF PAGE CONTENT">
<!-- Same as what's inside description meta tag -->
<!-- The description you want displayed when your page is linked to -->
<meta name="twitter:image" content="URL TO IMAGE">
<!-- This image must be less than 5MB, and either JPG, PNG, WEBP, or GIF -->
<!-- URL of image to be displayed when your site is linked to -->
<!-- Be careful when building non-static sites like your MS3 and MS4, this can be a little tricky -->
<meta name="twitter:image:alt" content="ALT TEXT FOR IMAGE">
<!-- Alt text for above image - an accessibility win -->
<meta name="twitter:site" content="@USERNAME"> <!-- The site's Twitter handle -->
<meta name="twitter:creator" content="@USERNAME"> <!-- Your personal Twitter handle -->
{% endblock %}

{% block content %}

<div class="container">
    <div class="row"> 
        {% for product in products %} 
        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mt-3">
            <div class="card">
                <img src="{{ product.image.url }}" class="menu-img" alt="{{ product.name }}">
                <div class="card-body">
                    <h5 class="card-title">{{ product.name }}</h5>
                    <p class="card-text">{{ product.short_description }}</p>
                </div>
                <div class=" card-body">
                    <p class="card-text">{{ product.description }}</p>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item"> Category: {{ product.category }}
                    </li>
                    <li class="list-group-item">Â£{{ product.price }}</li>
                </ul> 
                {% if request.user.is_superuser %} 
                <small class="ml-3">
                    <a href="{% url 'edit_product' product.id %}" class="card-link btn btn-info" role="button">Edit</a>
                </small>
                <!-- Button trigger modal -->
                <button type="button" class="btn btn-danger" data-bs-toggle="modal"
                    data-bs-target="#deleteProductModal{{ product.id }}"> Delete </button>
                <!-- Modal -->
                <div class="modal fade" id="deleteProductModal{{ product.id }}" data-bs-backdrop="static"
                    data-bs-keyboard="false" tabindex="-1" aria-labelledby="deleteProductLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="staticBackdropLabel">Delete</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">Are you sure you want to delete {{ product.name }}? </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <a class="btn btn-danger" href="{% url 'delete_product' product.id %}">Delete</a>
                            </div>
                        </div>
                    </div>
                </div> 
                {% else %} 
                <div class="card-body">
                    <a href="{% url 'product_detail' product.id %}" class="card-link btn btn-info" role="button">See
                        More Info</a>
                </div>
                <form class="form container" action="{% url 'add_to_cart' product.id %}" method="POST"> {% csrf_token %}
                    <div class="form-row">
                        <div class="col-12">
                            <h3>Add to Cart</h3>
                            <p class="mt-3">
                                <strong>Quantity:</strong>
                            </p>
                            <div class="form-group w-100">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <button class="decrement-qty btn 
                                            btn-black rounded-0" data-item_id="{{ product.id }}"
                                            id="decrement-qty_{{ product.id }}">
                                            <span class="icon">
                                                <i class="fas fa-minus"></i>
                                            </span>
                                        </button>
                                    </div> 
                                    {% for item in cart_items %} 
                                    <input class="form-control qty_input" type="number" name="quantity" value="{{ item.quantity }}" min="1" max="15"
                                        data-item_id="{{ product.id }}" id="id_qty_{{ product.id }}"> 
                                    {% empty %} 
                                    <input class="form-control qty_input" type="number" name="quantity" value=0 min="0"
                                        max="15" data-item_id="{{ product.id }}" id="id_qty_{{ product.id }}">
                                    {% endfor %} 
                                    <div class="input-group-append">
                                        <button class="increment-qty btn 
                                            btn-black rounded-0" data-item_id="{{ product.id }}"
                                            id="increment-qty_{{ product.id }}">
                                            <span class="icon">
                                                <i class="fas fa-plus"></i>
                                            </span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12"> 
                            {% if cart %} 
                            <a href="{% url 'checkout' %}" class="btn">
                                <span class="icon">
                                    <i class="fas fa-chevron-left"></i>
                                </span>
                                <span class="text-uppercase">Checkout</span>
                            </a> 
                            {% endif %} 
                            <input type="submit" class="btn btn-info" value="Add to Cart">
                        </div>
                        <!-- hidden form element to redirect back to page came from (redirect_url) -->
                        <input type="hidden" name="redirect_url" value="{{ request.path }}">
                    </div>
                </form> 
                {% endif %}
            </div>
        </div> 
        {% empty %} 
        NO PRODUCTS YET 
        {% endfor %} 
    </div>
</div> 
{% endblock %} 
{% block postloadjs %} 
{{ block.super }}
{% include 'products/includes/quantity_input_script.html' %} 
{% endblock %}